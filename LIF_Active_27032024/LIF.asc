Version 4
SHEET 1 3368 2324
WIRE 1920 -1296 1920 -1344
WIRE 128 -1168 128 -1328
WIRE 224 -1168 224 -1328
WIRE 304 -1168 304 -1328
WIRE 464 -1168 464 -1328
WIRE 544 -1168 544 -1328
WIRE 640 -1168 640 -1328
WIRE 1920 -1168 1920 -1216
WIRE 2032 -1168 1920 -1168
WIRE 1920 -1120 1920 -1168
WIRE 1040 -1088 1040 -1136
WIRE 1536 -1088 1536 -1120
WIRE 1504 -1072 1440 -1072
WIRE 2112 -1072 2112 -1104
WIRE 1632 -1056 1568 -1056
WIRE 2032 -1056 2032 -1168
WIRE 2080 -1056 2032 -1056
WIRE 1504 -1040 1280 -1040
WIRE 2208 -1040 2144 -1040
WIRE 2272 -1040 2208 -1040
WIRE 2080 -1024 2032 -1024
WIRE 1536 -992 1536 -1024
WIRE 1920 -992 1920 -1040
WIRE 1040 -976 1040 -1008
WIRE 2112 -976 2112 -1008
WIRE 1920 -864 1792 -864
WIRE 2032 -864 2032 -1024
WIRE 2032 -864 2000 -864
WIRE 2080 -864 2032 -864
WIRE 2208 -864 2208 -1040
WIRE 2208 -864 2160 -864
WIRE -480 -688 -576 -688
WIRE -304 -688 -416 -688
WIRE -896 -608 -1056 -608
WIRE -720 -608 -816 -608
WIRE -576 -608 -576 -688
WIRE -480 -608 -576 -608
WIRE -304 -608 -304 -688
WIRE -304 -608 -400 -608
WIRE 1232 -544 1168 -544
WIRE 208 -464 176 -464
WIRE 448 -464 272 -464
WIRE -896 -448 -1056 -448
WIRE -720 -448 -720 -608
WIRE -720 -448 -816 -448
WIRE -448 -448 -448 -480
WIRE -720 -432 -720 -448
WIRE -576 -432 -576 -608
WIRE -576 -432 -720 -432
WIRE -480 -432 -576 -432
WIRE 848 -432 816 -432
WIRE 992 -432 928 -432
WIRE 1104 -432 992 -432
WIRE 1232 -432 1232 -544
WIRE 1232 -432 1184 -432
WIRE -304 -416 -304 -608
WIRE -304 -416 -416 -416
WIRE -192 -416 -304 -416
WIRE -480 -400 -544 -400
WIRE 176 -368 176 -464
WIRE 208 -368 176 -368
WIRE 448 -368 448 -464
WIRE 448 -368 288 -368
WIRE -544 -352 -544 -400
WIRE -448 -352 -448 -384
WIRE 1056 -352 1056 -368
WIRE 992 -336 992 -432
WIRE 1024 -336 992 -336
WIRE 1232 -320 1232 -432
WIRE 1232 -320 1088 -320
WIRE 1520 -320 1232 -320
WIRE 1024 -304 992 -304
WIRE -192 -288 -192 -416
WIRE 32 -288 -192 -288
WIRE 176 -288 176 -368
WIRE 176 -288 112 -288
WIRE 1056 -272 1056 -288
WIRE 1520 -272 1520 -320
WIRE -896 -256 -1056 -256
WIRE -720 -256 -720 -432
WIRE -720 -256 -816 -256
WIRE 240 -240 240 -272
WIRE 1456 -240 1312 -240
WIRE 176 -224 176 -288
WIRE 208 -224 176 -224
WIRE 448 -208 448 -368
WIRE 448 -208 272 -208
WIRE 848 -208 448 -208
WIRE 992 -208 992 -304
WIRE 992 -208 928 -208
WIRE 1104 -208 992 -208
WIRE 1232 -208 1184 -208
WIRE 208 -192 176 -192
WIRE 2720 -192 2560 -192
WIRE 1376 -176 1376 -192
WIRE 448 -160 448 -208
WIRE 1456 -160 1456 -240
WIRE 1456 -160 1408 -160
WIRE 240 -144 240 -176
WIRE 1232 -144 1232 -208
WIRE 1312 -144 1312 -240
WIRE 1312 -144 1232 -144
WIRE 1344 -144 1312 -144
WIRE 1520 -128 1520 -192
WIRE 1520 -128 1408 -128
WIRE 1968 -128 1520 -128
WIRE 32 -112 -192 -112
WIRE 176 -112 176 -192
WIRE 176 -112 112 -112
WIRE 1376 -96 1376 -112
WIRE 2640 -96 2640 -128
WIRE 1792 -80 1744 -80
WIRE 1968 -80 1872 -80
WIRE 2560 -80 2560 -192
WIRE 2608 -80 2560 -80
WIRE 176 -64 176 -112
WIRE 448 -64 448 -96
WIRE 2720 -64 2720 -192
WIRE 2720 -64 2672 -64
WIRE 2912 -64 2720 -64
WIRE 3008 -64 2912 -64
WIRE 3024 -64 3008 -64
WIRE -464 -48 -560 -48
WIRE -288 -48 -400 -48
WIRE 2256 -48 2080 -48
WIRE 2368 -48 2256 -48
WIRE 2544 -48 2368 -48
WIRE 2608 -48 2544 -48
WIRE 1856 -32 1760 -32
WIRE 1968 -32 1936 -32
WIRE 2256 0 2256 -48
WIRE 2368 0 2368 -48
WIRE 2640 0 2640 -32
WIRE 1776 16 1728 16
WIRE 1968 16 1856 16
WIRE -880 32 -1056 32
WIRE -704 32 -800 32
WIRE -560 32 -560 -48
WIRE -464 32 -560 32
WIRE -288 32 -288 -48
WIRE -288 32 -384 32
WIRE 2112 48 2096 48
WIRE 2544 48 2544 -48
WIRE 176 80 176 16
WIRE 2016 96 2016 64
WIRE 2048 96 2048 64
WIRE 2112 96 2112 48
WIRE 2256 112 2256 64
WIRE -880 192 -1056 192
WIRE -704 192 -704 32
WIRE -704 192 -800 192
WIRE -432 192 -432 160
WIRE 2112 192 2112 176
WIRE 2544 192 2544 128
WIRE -704 208 -704 192
WIRE -560 208 -560 32
WIRE -560 208 -704 208
WIRE -464 208 -560 208
WIRE -288 224 -288 32
WIRE -288 224 -400 224
WIRE -192 224 -192 -112
WIRE -192 224 -288 224
WIRE -464 240 -528 240
WIRE 2816 240 2816 208
WIRE 2912 256 2912 -64
WIRE 2912 256 2848 256
WIRE 2640 272 2592 272
WIRE 2784 272 2720 272
WIRE -528 288 -528 240
WIRE -432 288 -432 256
WIRE 2112 288 2112 256
WIRE 2880 288 2848 288
WIRE 2368 320 2368 80
WIRE 2816 336 2816 304
WIRE 2544 352 2544 288
WIRE -880 384 -1056 384
WIRE -704 384 -704 208
WIRE -704 384 -800 384
WIRE 768 896 768 832
WIRE 1136 1008 1136 848
WIRE 768 1024 768 976
WIRE 1088 1024 768 1024
WIRE 1136 1152 1136 1104
WIRE 1664 1152 1392 1152
WIRE 768 1184 768 1024
WIRE 1488 1264 1488 1232
WIRE 1392 1280 1392 1152
WIRE 1456 1280 1392 1280
WIRE 1136 1296 1136 1232
WIRE 1136 1296 912 1296
WIRE 1664 1296 1664 1152
WIRE 1664 1296 1520 1296
WIRE 1760 1296 1664 1296
WIRE 1776 1296 1760 1296
WIRE 1136 1312 1136 1296
WIRE 1232 1312 1136 1312
WIRE 1344 1312 1312 1312
WIRE 1456 1312 1344 1312
WIRE 912 1328 912 1296
WIRE 1488 1360 1488 1328
WIRE 1136 1392 1136 1312
WIRE 1344 1392 1344 1312
WIRE 768 1440 768 1264
WIRE 768 1440 464 1440
WIRE 1344 1504 1344 1456
WIRE 128 1520 48 1520
WIRE 304 1520 192 1520
WIRE 416 1520 304 1520
WIRE 304 1552 304 1520
WIRE 464 1600 464 1536
WIRE 912 1600 912 1408
WIRE 1136 1600 1136 1456
WIRE 304 1664 304 1632
FLAG 1920 -992 0
FLAG 1920 -1344 Vdd
FLAG 2112 -1104 Vdd
FLAG 2112 -976 Vss
FLAG 1536 -1120 Vdd
FLAG 1536 -992 Vss
FLAG 1040 -976 0
FLAG 1040 -1136 Vth
FLAG 1440 -1072 Vth
FLAG 2256 112 0
FLAG 3008 -64 Vmem_out
FLAG 1792 -864 Vmem_out
FLAG 1632 -1056 Vmem_spiked
IOPIN 1632 -1056 Out
FLAG 2048 96 Vmem_spiked
FLAG 2016 96 C1_post
FLAG 2272 -1040 C1_post
FLAG 1744 -80 Vdd
FLAG 1760 -32 Vss
FLAG 1728 16 Vss
FLAG 2640 -128 Vdd
FLAG 2640 0 Vss
FLAG 2112 288 0
FLAG 1136 1600 0
FLAG 1488 1360 Vss
FLAG 1488 1232 Vdd
FLAG 912 1600 0
FLAG 464 1600 0
FLAG 48 1520 Vmem_spiked
FLAG 304 1664 0
FLAG 1344 1504 0
FLAG 768 832 V3_3
FLAG 1136 848 V3_3
FLAG 1760 1296 Vhebb
FLAG 1280 -1040 Vmem_out
FLAG -448 -480 Vdd
FLAG -448 -352 Vss
FLAG -544 -352 0
FLAG 176 80 0
FLAG -432 160 Vdd
FLAG -432 288 Vss
FLAG -528 288 0
FLAG 448 -64 0
FLAG 240 -272 Vdd
FLAG 240 -144 Vss
FLAG 2544 352 0
FLAG 2816 208 Vdd
FLAG 2816 336 Vss
FLAG 2880 288 0
FLAG -1056 -608 In_ext_0
IOPIN -1056 -608 In
FLAG -1056 32 In_inh_0
IOPIN -1056 32 In
FLAG -1056 -448 In_ext_1
IOPIN -1056 -448 In
FLAG -1056 -256 In_ext_2
IOPIN -1056 -256 In
FLAG -1056 192 In_inh_1
IOPIN -1056 192 In
FLAG -1056 384 In_inh_2
IOPIN -1056 384 In
FLAG 464 -1328 Vdd
IOPIN 464 -1328 BiDir
FLAG 544 -1328 Vss
IOPIN 544 -1328 BiDir
FLAG 640 -1328 V3_3
IOPIN 640 -1328 BiDir
FLAG 128 -1328 Vmem_spiked
IOPIN 128 -1328 Out
FLAG 224 -1328 Vhebb
IOPIN 224 -1328 Out
FLAG 304 -1328 Vmem_out
IOPIN 304 -1328 Out
FLAG 1056 -272 Vss
FLAG 1376 -96 Vss
FLAG 816 -432 0
FLAG 1056 -368 Vdd
FLAG 1376 -192 Vdd
FLAG 2368 320 0
SYMBOL AnalogMux 2016 -48 R0
SYMATTR InstName X1
SYMBOL OpAmps\\UniversalOpAmp2 2112 -1040 R0
SYMATTR InstName U1
SYMBOL res 2016 -880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 200k
SYMBOL res 2176 -880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 400k
SYMBOL res 1904 -1312 R0
SYMATTR InstName R3
SYMATTR Value 448k
SYMBOL res 1904 -1136 R0
SYMATTR InstName R4
SYMATTR Value 152k
SYMBOL OpAmps\\UniversalOpAmp2 1536 -1056 R0
SYMATTR InstName U2
SYMBOL voltage 1040 -1104 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 0.6
SYMBOL cap 2240 0 R0
SYMATTR InstName C1
SYMATTR Value 500n
SYMBOL res 2352 -16 R0
SYMATTR InstName R5
SYMATTR Value 250k
SYMBOL res 1872 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 1.6k
SYMBOL res 1952 -48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 600
SYMBOL res 1888 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 600
SYMBOL OpAmps\\UniversalOpAmp2 2640 -64 R0
SYMATTR InstName U3
SYMBOL cap 2096 192 R0
SYMATTR InstName C2
SYMATTR Value 10n
SYMBOL res 2096 80 R0
SYMATTR InstName R11
SYMATTR Value 100
SYMBOL pmos 1088 1104 M180
SYMATTR InstName M1
SYMATTR Value Si7540DP_P
SYMBOL cap 1152 1392 M0
SYMATTR InstName C3
SYMATTR Value 2n
SYMATTR SpiceLine Rser=50
SYMBOL res 1152 1136 M0
SYMATTR InstName R12
SYMATTR Value 3k
SYMBOL res 928 1312 M0
SYMATTR InstName R13
SYMATTR Value 5Meg
SYMBOL OpAmps\\UniversalOpAmp2 1488 1296 R0
SYMATTR InstName U4
SYMBOL res 752 880 R0
SYMATTR InstName R14
SYMATTR Value 40k
SYMBOL nmos 416 1440 R0
SYMATTR InstName M2
SYMATTR Value Si7540DP_N
SYMBOL cap 192 1504 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 400p
SYMATTR SpiceLine Rser=10
SYMBOL res 288 1536 R0
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL res 752 1168 R0
SYMATTR InstName R16
SYMATTR Value 5k
SYMBOL res 1328 1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 1Meg
SYMBOL cap 1328 1392 R0
SYMATTR InstName C5
SYMATTR Value 5p
SYMBOL res -384 -624 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 1Meg
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL res -800 -624 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 1Meg
SYMBOL res -800 -464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 1Meg
SYMBOL res -800 -272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 1Meg
SYMBOL res 304 -384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 5Meg
SYMBOL res 128 -304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 5Meg
SYMBOL res 128 -128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R25
SYMATTR Value 5Meg
SYMBOL res 160 -80 R0
SYMATTR InstName R26
SYMATTR Value 5Meg
SYMBOL OpAmps\\UniversalOpAmp2 -432 224 R0
SYMATTR InstName U5
SYMBOL res -368 16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 1Meg
SYMBOL res -784 16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 2Meg
SYMBOL res -784 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R29
SYMATTR Value 2Meg
SYMBOL res -784 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R30
SYMATTR Value 2Meg
SYMBOL cap 464 -96 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C6
SYMATTR Value 10p
SYMBOL cap -480 -672 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C7
SYMATTR Value 3p
SYMBOL OpAmps\\OPAx202 -448 -480 R0
SYMATTR InstName U6
SYMBOL OpAmps\\OPAx202 240 -272 R0
SYMATTR InstName U7
SYMBOL cap 208 -448 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C8
SYMATTR Value 2p
SYMBOL cap -464 -32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C9
SYMATTR Value 3p
SYMBOL nmos 2592 192 M0
SYMATTR InstName M3
SYMATTR Value QS6K21
SYMBOL res 2560 32 M0
SYMATTR InstName R31
SYMATTR Value 15k
SYMBOL OpAmps\\UniversalOpAmp2 2816 272 M0
SYMATTR InstName U8
SYMBOL res 2624 256 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R32
SYMATTR Value 3k
SYMBOL OpAmps\\UniversalOpAmp2 1056 -320 R0
SYMATTR InstName U13
SYMBOL res 944 -448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R33
SYMATTR Value 50k
SYMBOL res 1200 -448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R34
SYMATTR Value 50k
SYMBOL res 944 -224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R35
SYMATTR Value 50k
SYMBOL res 1200 -224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R36
SYMATTR Value 50k
SYMBOL OpAmps\\UniversalOpAmp2 1376 -144 M0
SYMATTR InstName U14
SYMBOL res 1504 -288 R0
SYMATTR InstName R37
SYMATTR Value 30k
SYMBOL cap 1168 -560 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C11
SYMATTR Value 10p
TEXT 2200 -184 Left 2 ;Scaled x40 +2.8V
TEXT 1264 1584 Left 2 ;filtering is overkill but when real mos is used maybe it will be needed
TEXT 2016 1192 Left 2 ;rounding at the top of feedback spike is issue, higher latency, no problem bc of peak detector
TEXT -32 1424 Left 2 ;Attention to reach treshold of NMOS
TEXT 1552 -1536 Left 2 ;spike monitoring circuit
TEXT 1832 -600 Left 2 ;spike generation circuit
TEXT -584 -776 Left 2 ;EXCITATORY Synaptic input
TEXT -568 -144 Left 2 ;INHIBITORY Synaptic input
TEXT -328 -848 Left 2 ;short while train
TEXT -280 -680 Left 2 ;not meant to be  integrator just for compensation
TEXT 16 -528 Left 2 ;not meant to be  integrator just for compensation
TEXT -1024 480 Left 2 ;ovde smanji gain znaci inhibitory sinpase nece davati 1V kao excitatory vec -0.5 ili -0.4
